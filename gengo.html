<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>YƒÅtra Lite ‚Äî Adaptive Trip Planner (Demo)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .glass { background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.18); backdrop-filter: blur(10px); }
    .btn { transition: transform .08s ease, box-shadow .2s ease, background-color .2s ease; }
    .btn:active { transform: translateY(1px); }
    .soft-shadow { box-shadow: 0 12px 34px rgba(0,0,0,.22); }
    .badge { background: rgba(255,255,255,.14); }
    .dot { width:10px; height:10px; border-radius:9999px; }
    .progress { height: 10px; border-radius: 9999px; background: rgba(255,255,255,.18); overflow: hidden; }
    .progress > span { display:block; height:100%; border-radius:9999px; }

    /* Creative background blobs */
    #creativeBg .blob{
      position:absolute; width:38vmax; height:38vmax; border-radius:50%;
      background: radial-gradient(closest-side, rgba(255,255,255,.18), rgba(255,255,255,0));
      filter: blur(10px);
      animation: float 12s ease-in-out infinite;
    }
    @keyframes float{ 0%,100%{ transform: translateY(0) scale(1);} 50%{ transform: translateY(-20px) scale(1.05);} }

    /* Nice scrollbar */
    ::-webkit-scrollbar { width: 10px; height: 10px; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,.25); border-radius: 9999px; }
    ::-webkit-scrollbar-track { background: transparent; }

    .chip { background: rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.15); }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-900 via-violet-800 to-fuchsia-800 text-white overflow-x-hidden">
  <!-- Demo banner -->
  <div class="w-full text-center py-2 px-4 text-sm bg-black/30 border-b border-white/10">
    <span class="font-semibold">Demo</span>: Mood, AI, and micro‚Äëinfluencer features are simulated locally. No real APIs or bookings here.
  </div>

  <!-- Creative background -->
  <div id="creativeBg" class="pointer-events-none fixed inset-0 opacity-0 transition-opacity duration-500">
    <span class="blob" style="top:10%; left:5%;"></span>
    <span class="blob" style="top:60%; left:10%; animation-delay: .6s;"></span>
    <span class="blob" style="top:20%; right:8%; animation-delay: 1.2s;"></span>
    <span class="blob" style="bottom:8%; right:12%; animation-delay: 1.8s;"></span>
  </div>

  <header class="max-w-7xl mx-auto px-6 md:px-10 pt-8">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div>
        <h1 class="text-3xl md:text-4xl font-extrabold tracking-tight">YƒÅtra Lite ¬∑ Adaptive Trip Planner</h1>
        <p class="text-white/80 mt-1">Pick a place, set your mood, and get a smart, hyperlocal itinerary.</p>
      </div>
      <div class="flex items-center gap-2">
        <div class="glass rounded-xl px-2 py-1 flex items-center gap-2">
          <span class="text-xs opacity-80">Creative Mode</span>
          <label class="relative inline-flex items-center cursor-pointer select-none">
            <input id="creativeToggle" type="checkbox" class="sr-only peer">
            <div class="w-11 h-6 bg-white/20 rounded-full peer peer-checked:bg-rose-400 transition-colors"></div>
            <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform peer-checked:translate-x-5"></span>
          </label>
        </div>
        <button id="aboutBtn" class="btn glass rounded-xl px-4 py-2 text-sm hover:bg-white/20">About this demo</button>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-6 md:px-10 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
      <!-- Left: Setup -->
      <section class="lg:col-span-4 space-y-6">
        <div class="glass rounded-2xl p-5 soft-shadow">
          <h2 class="text-xl font-bold mb-4">Trip setup</h2>
          <form id="plannerForm" class="space-y-5">
            <div>
              <label class="block text-sm mb-2">Destination</label>
              <!-- Season accordions -->
              <div class="space-y-2" id="destAccordions">
                <!-- Summer -->
                <button type="button" class="w-full chip rounded-xl px-3 py-2 flex items-center justify-between hover:bg-white/20" data-acc-btn="summer">
                  <span>‚òÄÔ∏è Summer (Mar‚ÄìJun)</span>
                  <span class="text-xs opacity-80" data-acc-icon="summer">Show</span>
                </button>
                <div id="summerChips" class="hidden pl-2 flex flex-wrap gap-2"></div>

                <!-- Monsoon -->
                <button type="button" class="w-full chip rounded-xl px-3 py-2 flex items-center justify-between hover:bg-white/20" data-acc-btn="monsoon">
                  <span>üçÇ Monsoon (Jul‚ÄìSep)</span>
                  <span class="text-xs opacity-80" data-acc-icon="monsoon">Show</span>
                </button>
                <div id="monsoonChips" class="hidden pl-2 flex flex-wrap gap-2"></div>

                <!-- Winter -->
                <button type="button" class="w-full chip rounded-xl px-3 py-2 flex items-center justify-between hover:bg-white/20" data-acc-btn="winter">
                  <span>‚ùÑÔ∏è Winter (Oct‚ÄìFeb)</span>
                  <span class="text-xs opacity-80" data-acc-icon="winter">Show</span>
                </button>
                <div id="winterChips" class="hidden pl-2 flex flex-wrap gap-2"></div>

                <!-- All-Year -->
                <button type="button" class="w-full chip rounded-xl px-3 py-2 flex items-center justify-between hover:bg-white/20" data-acc-btn="allyear">
                  <span>üå¥ All‚ÄëYear</span>
                  <span class="text-xs opacity-80" data-acc-icon="allyear">Show</span>
                </button>
                <div id="allyearChips" class="hidden pl-2 flex flex-wrap gap-2"></div>
              </div>
              <p class="text-xs text-white/70 mt-2">Tip: open a season and choose one place.</p>
            </div>

            <div class="grid grid-cols-2 gap-3">
              <div>
                <label class="block text-sm mb-2">Days</label>
                <select id="days" class="w-full bg-white/10 border border-white/20 rounded-xl px-3 py-2 focus:outline-none">
                  <option>2</option>
                  <option selected>3</option>
                  <option>4</option>
                  <option>5</option>
                </select>
              </div>
              <div>
                <label class="block text-sm mb-2">Pace</label>
                <select id="pace" class="w-full bg-white/10 border border-white/20 rounded-xl px-3 py-2 focus:outline-none">
                  <option value="relaxed">Relaxed</option>
                  <option value="balanced" selected>Balanced</option>
                  <option value="packed">Packed</option>
                </select>
              </div>
            </div>

            <div>
              <label class="block text-sm mb-2">Mood Catcher</label>
              <div class="flex items-center gap-3">
                <span class="text-xs opacity-80">Chill</span>
                <input id="mood" type="range" min="0" max="100" value="40" class="w-full accent-fuchsia-400">
                <span class="text-xs opacity-80">Adventure</span>
              </div>
              <div class="progress mt-2"><span id="moodBar" class="bg-fuchsia-400" style="width:40%"></span></div>
            </div>

            <div class="grid grid-cols-2 gap-3">
              <label class="flex items-center gap-2">
                <input id="budget" type="checkbox" class="accent-fuchsia-400">
                <span class="text-sm">Budget friendly</span>
              </label>
              <label class="flex items-center gap-2">
                <input id="early" type="checkbox" class="accent-fuchsia-400">
                <span class="text-sm">Early riser</span>
              </label>
            </div>

            <div class="flex gap-2 pt-2">
              <button id="generateBtn" class="btn bg-fuchsia-500 hover:bg-fuchsia-600 text-white rounded-xl px-4 py-2 soft-shadow">Generate plan</button>
              <button id="shuffleBtn" type="button" class="btn glass hover:bg-white/20 rounded-xl px-4 py-2">Shuffle day</button>
            </div>
          </form>
        </div>

        <div class="glass rounded-2xl p-5 soft-shadow">
          <h3 class="text-lg font-semibold mb-3">Hyperlocal picks</h3>
          <div id="picks" class="space-y-3 max-h-80 overflow-auto pr-1"></div>
        </div>

        <div class="glass rounded-2xl p-5 soft-shadow">
          <h3 class="text-lg font-semibold mb-3">Micro‚Äëinfluencer whispers</h3>
          <div id="influencers" class="space-y-3"></div>
        </div>
      </section>

      <!-- Right: Itinerary -->
      <section class="lg:col-span-8 space-y-6">
        <div class="glass rounded-2xl p-5 soft-shadow">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold">Your adaptive itinerary</h2>
            <div class="flex gap-2">
              <button id="copyBtn" class="btn glass hover:bg-white/20 rounded-xl px-3 py-2 text-sm">Copy summary</button>
              <button id="clearBtn" class="btn glass hover:bg-white/20 rounded-xl px-3 py-2 text-sm">Clear</button>
            </div>
          </div>
          <div id="planMeta" class="text-sm text-white/80 mb-4"></div>
          <div id="itinerary" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
        </div>

        <div class="glass rounded-2xl p-5 soft-shadow">
          <h3 class="text-lg font-semibold mb-3">Notes</h3>
          <ul class="list-disc list-inside text-white/85 text-sm space-y-1">
            <li>This is a local demo. All suggestions are handcrafted examples.</li>
            <li>Creative Mode adds playful ideas and a dreamy background.</li>
            <li>Shuffle day to swap activities within the same vibe.</li>
          </ul>
        </div>
      </section>
    </div>
  </main>

  <!-- About modal -->
  <div id="aboutModal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/60"></div>
    <div class="relative max-w-xl mx-auto mt-24 bg-white text-slate-900 rounded-2xl p-6 shadow-2xl">
      <h3 class="text-xl font-bold">About this demo</h3>
      <p class="mt-2 text-sm text-slate-700">
        YƒÅtra Lite simulates an adaptive trip planner with mood‚Äëbased suggestions, hyperlocal picks, and micro‚Äëinfluencer style notes. No external APIs or bookings are used.
      </p>
      <div class="mt-4 flex justify-end gap-2">
        <button id="closeAbout" class="btn rounded-xl bg-slate-900 text-white px-3 py-2 hover:bg-slate-800">Close</button>
      </div>
    </div>
  </div>

  <script>
    // Data: destinations requested + content
    const DESTS = [ // base content for known places; new grouped destinations fall back to simple pools if missing
      { id:'leh', name:'Leh‚ÄëLadakh', emoji:'üóª', tags:['mountains','adventure','cold'], 
        picks:[
          {title:'Shanti Stupa sunset', type:'viewpoint', cost:'free', tip:'Walk the stairs; bring a jacket.'},
          {title:'Turtuk village stroll', type:'village', cost:'‚Çπ', tip:'Try apricot products from locals.'},
          {title:'Magnetic Hill & Hall of Fame', type:'sights', cost:'‚Çπ', tip:'Go early for fewer crowds.'},
        ],
        activities:{
          chill:['Monastery loop (Thiksey ‚Ä¢ Hemis)','Leh market caf√© hop','Shanti Stupa & quiet sunset'],
          active:['Khardung La drive & short hike','Nubra sand dunes + ATV','Pangong Tso lakeside walk'],
          night:['Stargazing outside Leh','Thukpa + momo dinner','Bonfire at homestay (when allowed)']
        },
        influencers:[
          {handle:'@tinyboots', note:'Skip noon sun at Pangong; colors pop at 4‚Äì6pm.'},
          {handle:'@soulonroads', note:'Carry cash‚ÄîATMs can be spotty beyond Leh.'}
        ]
      },
      { id:'manali_shimla', name:'Manali & Shimla', emoji:'üèûÔ∏è', tags:['mountains','evergreen'],
        picks:[
          {title:'Old Manali brunch lane', type:'food', cost:'‚Çπ‚Çπ', tip:'Go for Himalayan trout.'},
          {title:'Jakhoo Temple monkeys', type:'temple', cost:'free', tip:'Keep snacks sealed.'},
          {title:'Mall Road heritage walk', type:'walk', cost:'free', tip:'Evening is best for lights.'},
        ],
        activities:{
          chill:['Hadimba temple + cedar forest','Vashisht hot springs soak','Shimla ridge and caf√© crawl'],
          active:['Solang Valley cable + short trek','Ski/snow-play (seasonal)','Kufri adventure park'],
          night:['Bonfire & acoustic night','Mall Road snacks tour','Stargaze near outskirts']
        },
        influencers:[
          {handle:'@hillnotes', note:'Weekdays beat weekend crowds by a mile.'},
          {handle:'@chaiandtrails', note:'Layer up; mountain weather swings fast.'}
        ]
      },
      { id:'kerala', name:'Kerala', emoji:'üå¥', tags:['backwaters','beach','slow'],
        picks:[
          {title:'Alleppey shikara', type:'backwater', cost:'‚Çπ‚Çπ', tip:'2‚Äì3hr ride is the sweet spot.'},
          {title:'Kochi mural lanes', type:'culture', cost:'free', tip:'Fort Kochi for art + caf√©s.'},
          {title:'Munnar tea slopes', type:'nature', cost:'‚Çπ', tip:'Sunrise views are magical.'},
        ],
        activities:{
          chill:['Backwater cruise + toddy shop lunch','Ayurvedic massage','Kochi heritage & art caf√©s'],
          active:['Eravikulam park hike','Kayak small canals','Varkala cliff walk'],
          night:['Kathakali performance','Seafood dinner by the shore','Houseboat stargazing']
        },
        influencers:[
          {handle:'@malabarmap', note:'Try a local ‚Äúmeals‚Äù thali‚Äîgreat value.'},
          {handle:'@tealeaftrails', note:'Buy tea at estates, fresher than city stores.'}
        ]
      },
      { id:'andaman', name:'Andaman & Nicobar Islands', emoji:'üèùÔ∏è', tags:['beach','islands','dive'],
        picks:[
          {title:'Radhanagar Beach (Havelock)', type:'beach', cost:'free', tip:'Sunset is prime time.'},
          {title:'Snorkel at Elephant Beach', type:'snorkel', cost:'‚Çπ‚Çπ', tip:'Carry reef‚Äësafe sunscreen.'},
          {title:'Cellular Jail light show', type:'history', cost:'‚Çπ', tip:'Book evening slot in advance.'},
        ],
        activities:{
          chill:['Beach‚Äëhopping day','Laze in hammocks + read','Tide‚Äëpooling & shell hunt'],
          active:['Discover scuba/reef snorkel','Kayak mangroves at dawn','Limestone cave day trip (Baratang)'],
          night:['Seafood grill night','Starry beach walk','Night bioluminescence (seasonal)']
        },
        influencers:[
          {handle:'@reefpeek', note:'Leave no trace‚Äîreefs are delicate.'},
          {handle:'@islandnotes', note:'Ferries can shift‚Äîkeep day 1 flexible.'}
        ]
      },
      { id:'mumbai', name:'Mumbai', emoji:'üåÜ', tags:['city','food','culture'],
        picks:[
          {title:'Colaba heritage loop', type:'walk', cost:'free', tip:'Start at Gateway, end at Kala Ghoda.'},
          {title:'Girgaum Chowpatty snacks', type:'food', cost:'‚Çπ', tip:'Try bhel + kulfi combo.'},
          {title:'Bandra street art', type:'art', cost:'free', tip:'Chapel Rd and Perry Cross area.'},
        ],
        activities:{
          chill:['Marine Drive sunset sit‚Äëout','Colaba caf√©s & galleries','Bandra‚ÄëFort breezy evening'],
          active:['Dawn city tour & vada pav','Sanjay Gandhi NP mini trek','Dharavi craft experience (ethical)'],
          night:['Sea‚Äëfacing dinner','Live gig night','Late‚Äënight kulfi trail']
        },
        influencers:[
          {handle:'@mumbailens', note:'Local trains off‚Äëpeak are fastest.'},
          {handle:'@eatstreets', note:'Street food? Choose busy, high‚Äëturnover stalls.'}
        ]
      },
      { id:'delhi', name:'Delhi', emoji:'üïå', tags:['history','food','city'],
        picks:[
          {title:'Humayun‚Äôs Tomb morning', type:'history', cost:'‚Çπ‚Çπ', tip:'Soft light, fewer crowds.'},
          {title:'Old Delhi food crawl', type:'food', cost:'‚Çπ', tip:'Paranthe Wali Gali + jalebis.'},
          {title:'Lodhi Art District', type:'art', cost:'free', tip:'Golden hour photos pop.'},
        ],
        activities:{
          chill:['Lodhi Garden picnic','Museum + caf√© (NGMA/KNMA)','Hauz Khas lake stroll'],
          active:['Red Fort + Jama Masjid','Qutub Complex deep dive','Cycle tour at dawn'],
          night:['Sufi qawwali (Thu) Nizamuddin','Dilli Haat craft + dinner','CP night walk & ice cream']
        },
        influencers:[
          {handle:'@dillidil', note:'Monday closures‚Äîcheck monument schedules.'},
          {handle:'@spicepath', note:'Carry a scarf for religious sites.'}
        ]
      },
      { id:'pondy', name:'Pondicherry', emoji:'üåä', tags:['beach','french','slow'],
        picks:[
          {title:'White Town pastel lanes', type:'walk', cost:'free', tip:'Mornings = best colors, fewer cars.'},
          {title:'Auroville bakery stop', type:'food', cost:'‚Çπ‚Çπ', tip:'Almond croissant is a fave.'},
          {title:'Serenity Beach surf', type:'surf', cost:'‚Çπ‚Çπ', tip:'Early swell is friendliest.'},
        ],
        activities:{
          chill:['Promenade sunrise cycle','Caf√©‚Äëhop in White Town','Auroville meditation visit'],
          active:['Surf lesson at Serenity','Day trip to Paradise Beach','Kayak the mangroves'],
          night:['Creole dinner','Gelato + seaside walk','Boutique shopping loop']
        },
        influencers:[
          {handle:'@pastelporch', note:'Midday heat is harsh‚Äîplan siesta time.'},
          {handle:'@baybreeze', note:'Scooters are perfect for short hops.'}
        ]
      }
    ];

    // UI refs
    const destChips = document.getElementById('destChips');
    const picksEl = document.getElementById('picks');
    const inflEl = document.getElementById('influencers');
    const itineraryEl = document.getElementById('itinerary');
    const planMeta = document.getElementById('planMeta');
    const daysSel = document.getElementById('days');
    const paceSel = document.getElementById('pace');
    const moodRange = document.getElementById('mood');
    const moodBar = document.getElementById('moodBar');
    const budgetCb = document.getElementById('budget');
    const earlyCb = document.getElementById('early');
    const generateBtn = document.getElementById('generateBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const copyBtn = document.getElementById('copyBtn');
    const clearBtn = document.getElementById('clearBtn');
    const creativeToggle = document.getElementById('creativeToggle');
    const creativeBg = document.getElementById('creativeBg');
    const aboutBtn = document.getElementById('aboutBtn');
    const aboutModal = document.getElementById('aboutModal');
    const closeAbout = document.getElementById('closeAbout');

    // State
    const state = {
      destId: DESTS[0].id,
      dayCount: 3,
      mood: 40, // 0 chill ‚Äî 100 adventure
      pace: 'balanced',
      budget: false,
      early: false,
      creative: false,
      plan: []
    };

    // Build destination chips grouped by season
    function renderDestChips(){
      const groups = {
        summer: [
          {id:'shimla', name:'Shimla', emoji:'üèûÔ∏è'},
          {id:'manali', name:'Manali', emoji:'üèîÔ∏è'},
          {id:'darjeeling', name:'Darjeeling', emoji:'üöû'},
          {id:'ooty', name:'Ooty', emoji:'üåø'},
          {id:'shillong', name:'Shillong', emoji:'‚õ∞Ô∏è'},
          {id:'munnar_only', name:'Munnar', emoji:'ü´ñ'}
        ],
        monsoon: [
          {id:'goa', name:'Goa', emoji:'üèñÔ∏è'},
          {id:'cherrapunji', name:'Cherrapunji', emoji:'üåßÔ∏è'},
          {id:'coorg', name:'Coorg', emoji:'‚òï'},
          {id:'lonavala', name:'Lonavala & Khandala', emoji:'‚õÖ'},
          {id:'alleppey', name:'Alleppey', emoji:'üõ∂'}
        ],
        winter: [
          {id:'gulmarg', name:'Gulmarg', emoji:'‚õ∑Ô∏è'},
          {id:'leh', name:'Leh‚ÄëLadakh', emoji:'üóª'},
          {id:'jaipur', name:'Jaipur', emoji:'üè∞'},
          {id:'udaipur', name:'Udaipur', emoji:'üèûÔ∏è'},
          {id:'jaisalmer', name:'Jaisalmer', emoji:'üèúÔ∏è'},
          {id:'rann', name:'Rann of Kutch', emoji:'üèúÔ∏è'}
        ],
        allyear: [
          {id:'agra', name:'Agra', emoji:'üïå'},
          {id:'delhi', name:'Delhi', emoji:'üïå'},
          {id:'mumbai', name:'Mumbai', emoji:'üåÜ'},
          {id:'bengaluru', name:'Bengaluru', emoji:'üå≥'},
          {id:'hyderabad', name:'Hyderabad', emoji:'üßø'}
        ]
      };

      const makeChip = (d) => {
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'chip rounded-full px-3 py-1 text-sm hover:bg-white/20 transition';
        btn.textContent = `${d.emoji} ${d.name}`;
        btn.setAttribute('data-id', d.id);
        if (d.id === state.destId) btn.classList.add('ring-2','ring-fuchsia-400');
        btn.addEventListener('click', () => {
          state.destId = d.id;
          // Clear all selected rings
          document.querySelectorAll('#destAccordions .chip.rounded-full').forEach(c=>c.classList.remove('ring-2','ring-fuchsia-400'));
          btn.classList.add('ring-2','ring-fuchsia-400');
          renderPicks();
          renderInfluencers();
        });
        return btn;
      };

      const summerBox = document.getElementById('summerChips');
      const monsoonBox = document.getElementById('monsoonChips');
      const winterBox = document.getElementById('winterChips');
      const allyearBox = document.getElementById('allyearChips');
      [summerBox, monsoonBox, winterBox, allyearBox].forEach(el=> el.innerHTML='');

      groups.summer.forEach(d=> summerBox.appendChild(makeChip(d)));
      groups.monsoon.forEach(d=> monsoonBox.appendChild(makeChip(d)));
      groups.winter.forEach(d=> winterBox.appendChild(makeChip(d)));
      groups.allyear.forEach(d=> allyearBox.appendChild(makeChip(d)));

      // Accordion toggles
      document.querySelectorAll('[data-acc-btn]').forEach(btn=>{
        btn.onclick = () => {
          const key = btn.getAttribute('data-acc-btn');
          const box = document.getElementById(key+"Chips");
          const icon = document.querySelector(`[data-acc-icon="${key}"]`);
          const isHidden = box.classList.contains('hidden');
          // Close others
          ['summer','monsoon','winter','allyear'].forEach(k=>{
            const b = document.getElementById(k+"Chips");
            const i = document.querySelector(`[data-acc-icon="${k}"]`);
            if (k!==key){ b.classList.add('hidden'); i.textContent = 'Show'; }
          });
          box.classList.toggle('hidden');
          icon.textContent = isHidden ? 'Hide' : 'Show';
        };
      });
    }

    // Render hyperlocal picks
    function renderPicks(){
      let d = DESTS.find(x=>x.id===state.destId);
      // Fallback template for simple destinations
      if(!d){
        d = {
          id: state.destId,
          name: document.querySelector(`[data-id="${state.destId}"]`)?.textContent?.replace(/^\S+\s/,'') || 'Destination',
          emoji: 'üìç',
          tags: ['explore'],
          picks:[
            {title:'Top landmark', type:'sight', cost:'‚Çπ', tip:'Go early or late.'},
            {title:'Local food lane', type:'food', cost:'‚Çπ', tip:'Pick busy, clean stalls.'},
            {title:'Sunset viewpoint', type:'view', cost:'free', tip:'Carry water.'},
          ],
          activities:{
            chill:['Easy heritage walk','Cafe hop','Park picnic'],
            active:['Short hike or cycle','Museum + market loop','Sunrise photo walk'],
            night:['Local music night','Street snacks crawl','Night viewpoint']
          },
          influencers:[
            {handle:'@localtips', note:'Respect local customs and nature.'}
          ]
        };
      }
      picksEl.innerHTML = '';
      d.picks.forEach(p => {
        const row = document.createElement('div');
        row.className = 'flex items-start justify-between gap-3 bg-white/5 rounded-xl p-3 border border-white/10';
        row.innerHTML = `
          <div>
            <div class="font-semibold">${p.title}</div>
            <div class="text-xs text-white/75">${p.type} ‚Ä¢ ${p.cost}</div>
            <div class="text-xs text-white/80 mt-1">Tip: ${p.tip}</div>
          </div>
          <button class="btn text-xs bg-fuchsia-500 hover:bg-fuchsia-600 rounded-lg px-2 py-1">Add</button>
        `;
        const addBtn = row.querySelector('button');
        addBtn.addEventListener('click', () => addPickToPlan(p.title));
        picksEl.appendChild(row);
      });
    }

    // Render influencer notes
    function renderInfluencers(){
      let d = DESTS.find(x=>x.id===state.destId);
      // Fallback template for simple destinations
      if(!d){
        d = {
          id: state.destId,
          name: document.querySelector(`[data-id="${state.destId}"]`)?.textContent?.replace(/^\S+\s/,'') || 'Destination',
          emoji: 'üìç',
          tags: ['explore'],
          picks:[
            {title:'Top landmark', type:'sight', cost:'‚Çπ', tip:'Go early or late.'},
            {title:'Local food lane', type:'food', cost:'‚Çπ', tip:'Pick busy, clean stalls.'},
            {title:'Sunset viewpoint', type:'view', cost:'free', tip:'Carry water.'},
          ],
          activities:{
            chill:['Easy heritage walk','Cafe hop','Park picnic'],
            active:['Short hike or cycle','Museum + market loop','Sunrise photo walk'],
            night:['Local music night','Street snacks crawl','Night viewpoint']
          },
          influencers:[
            {handle:'@localtips', note:'Respect local customs and nature.'}
          ]
        };
      }
      inflEl.innerHTML = '';
      d.influencers.forEach(i => {
        const card = document.createElement('div');
        card.className = 'bg-white/5 rounded-xl p-3 border border-white/10';
        card.innerHTML = `
          <div class="flex items-center gap-2">
            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-fuchsia-400 to-rose-400 flex items-center justify-center text-slate-900 font-bold">‚ú¶</div>
            <div class="font-semibold">${i.handle}</div>
          </div>
          <div class="text-sm text-white/85 mt-1">${i.note}</div>
        `;
        inflEl.appendChild(card);
      });
    }

    // Mood UI
    moodRange.addEventListener('input', (e)=>{
      state.mood = +e.target.value;
      moodBar.style.width = state.mood + '%';
    });

    // Plan generation
    function buildDay(d, dayIndex){
      // Choose pools based on mood
      const mood = state.mood;
      const pools = {
        morning: mood < 45 ? d.activities.chill : (mood > 70 ? d.activities.active : d.activities.chill),
        afternoon: mood > 60 ? d.activities.active : d.activities.chill,
        evening: d.activities.night
      };

      // Early riser shifts an active to morning
      if (state.early && mood > 50) pools.morning = d.activities.active;

      const pick = arr => arr[Math.floor(Math.random()*arr.length)];

      const slots = [];
      const cap = state.pace === 'relaxed' ? 2 : (state.pace === 'packed' ? 4 : 3);
      const labels = ['Morning','Afternoon','Evening','Flex'];
      const poolsOrdered = [pools.morning, pools.afternoon, pools.evening, [...pools.morning, ...pools.afternoon]];

      for (let i=0;i<cap;i++){
        let idea = pick(poolsOrdered[i % poolsOrdered.length]);
        // Creative mode may add playful twist
        if (state.creative && Math.random()>.5){
          const twists = ['+ sketch what you see','+ try 3 strangers‚Äô recos','+ no‚Äëmaps mini detour','+ photo‚Äëonly hour'];
          idea += ' ' + pick(twists);
        }
        // Budget filter nudges toward simpler choices
        if (state.budget && idea.toLowerCase().includes('dinner')) idea = idea.replace(/dinner/i, 'snack crawl');
        slots.push({ label: labels[i], idea, id: crypto.randomUUID() });
      }
      return slots;
    }

    function generatePlan(){
      let d = DESTS.find(x=>x.id===state.destId);
      // Fallback template for simple destinations
      if(!d){
        d = {
          id: state.destId,
          name: document.querySelector(`[data-id="${state.destId}"]`)?.textContent?.replace(/^\S+\s/,'') || 'Destination',
          emoji: 'üìç',
          tags: ['explore'],
          picks:[
            {title:'Top landmark', type:'sight', cost:'‚Çπ', tip:'Go early or late.'},
            {title:'Local food lane', type:'food', cost:'‚Çπ', tip:'Pick busy, clean stalls.'},
            {title:'Sunset viewpoint', type:'view', cost:'free', tip:'Carry water.'},
          ],
          activities:{
            chill:['Easy heritage walk','Cafe hop','Park picnic'],
            active:['Short hike or cycle','Museum + market loop','Sunrise photo walk'],
            night:['Local music night','Street snacks crawl','Night viewpoint']
          },
          influencers:[
            {handle:'@localtips', note:'Respect local customs and nature.'}
          ]
        };
      }
      const days = +daysSel.value;
      state.dayCount = days;
      state.pace = paceSel.value;
      state.plan = Array.from({length: days}, (_,i)=>buildDay(d, i));
      renderItinerary();
      renderMeta();
    }

    function renderItinerary(){
      itineraryEl.innerHTML = '';
      state.plan.forEach((slots, dayIdx) => {
        const card = document.createElement('div');
        card.className = 'rounded-2xl bg-white/5 border border-white/10 p-4 flex flex-col';
        const dayTitle = `Day ${dayIdx+1}`;
        const list = slots.map(s => `
          <li class="group flex items-start justify-between gap-3 bg-white/5 rounded-xl p-3 border border-white/10">
            <div>
              <div class="text-xs text-white/70">${s.label}</div>
              <div class="font-semibold leading-snug">${s.idea}</div>
            </div>
            <button data-id="${s.id}" class="btn shrink-0 text-xs rounded-lg px-2 py-1 bg-rose-500 hover:bg-rose-600">Swap</button>
          </li>
        `).join('');

        card.innerHTML = `
          <div class="flex items-center justify-between mb-3">
            <div class="font-bold">${dayTitle}</div>
            <div class="text-xs text-white/70">${state.pace} ‚Ä¢ mood ${state.mood}</div>
          </div>
          <ul class="space-y-2">${list}</ul>
        `;
        itineraryEl.appendChild(card);

        // Wire up swap buttons
        card.querySelectorAll('button[data-id]').forEach(btn=>{
          btn.addEventListener('click', ()=>{
            swapIdea(dayIdx, btn.getAttribute('data-id'));
          });
        });
      });
    }

    function renderMeta(){
      let d = DESTS.find(x=>x.id===state.destId);
      // Fallback template for simple destinations
      if(!d){
        d = {
          id: state.destId,
          name: document.querySelector(`[data-id="${state.destId}"]`)?.textContent?.replace(/^\S+\s/,'') || 'Destination',
          emoji: 'üìç',
          tags: ['explore'],
          picks:[
            {title:'Top landmark', type:'sight', cost:'‚Çπ', tip:'Go early or late.'},
            {title:'Local food lane', type:'food', cost:'‚Çπ', tip:'Pick busy, clean stalls.'},
            {title:'Sunset viewpoint', type:'view', cost:'free', tip:'Carry water.'},
          ],
          activities:{
            chill:['Easy heritage walk','Cafe hop','Park picnic'],
            active:['Short hike or cycle','Museum + market loop','Sunrise photo walk'],
            night:['Local music night','Street snacks crawl','Night viewpoint']
          },
          influencers:[
            {handle:'@localtips', note:'Respect local customs and nature.'}
          ]
        };
      }
      const tags = d.tags.map(t=>`<span class="badge rounded-full px-2 py-0.5 text-xs mr-1">${t}</span>`).join('');
      planMeta.innerHTML = `
        <div class="flex flex-wrap items-center gap-2">
          <span class="text-white/90">${d.emoji} <span class="font-semibold">${d.name}</span></span>
          ${tags}
          <span class="text-white/70">‚Ä¢</span>
          <span class="text-white/80">${state.dayCount} days</span>
          <span class="text-white/70">‚Ä¢</span>
          <span class="text-white/80">${state.pace}</span>
          ${state.budget ? '<span class="text-emerald-300">‚Ä¢ budget focus</span>' : ''}
          ${state.early ? '<span class="text-amber-300">‚Ä¢ early riser</span>' : ''}
        </div>
      `;
    }

    function swapIdea(dayIdx, slotId){
      let d = DESTS.find(x=>x.id===state.destId);
      // Fallback template for simple destinations
      if(!d){
        d = {
          id: state.destId,
          name: document.querySelector(`[data-id="${state.destId}"]`)?.textContent?.replace(/^\S+\s/,'') || 'Destination',
          emoji: 'üìç',
          tags: ['explore'],
          picks:[
            {title:'Top landmark', type:'sight', cost:'‚Çπ', tip:'Go early or late.'},
            {title:'Local food lane', type:'food', cost:'‚Çπ', tip:'Pick busy, clean stalls.'},
            {title:'Sunset viewpoint', type:'view', cost:'free', tip:'Carry water.'},
          ],
          activities:{
            chill:['Easy heritage walk','Cafe hop','Park picnic'],
            active:['Short hike or cycle','Museum + market loop','Sunrise photo walk'],
            night:['Local music night','Street snacks crawl','Night viewpoint']
          },
          influencers:[
            {handle:'@localtips', note:'Respect local customs and nature.'}
          ]
        };
      }
      const slots = state.plan[dayIdx];
      const idx = slots.findIndex(s=>s.id===slotId);
      if (idx<0) return;
      // Choose a new idea from a combined pool to keep variety
      const pool = [...d.activities.chill, ...d.activities.active, ...d.activities.night];
      let newIdea = pool[Math.floor(Math.random()*pool.length)];
      if (state.creative && Math.random()>.5){
        const twists = ['+ 10min sketch','+ ask for a local story','+ taste something new','+ sunset pause'];
        newIdea += ' ' + twists[Math.floor(Math.random()*twists.length)];
      }
      if (state.budget && /dinner/i.test(newIdea)) newIdea = newIdea.replace(/dinner/i,'snack crawl');
      // Update one slot in place for smoothness
      const newSlot = {...slots[idx], idea:newIdea};
      state.plan[dayIdx].splice(idx, 1, newSlot);
      // Update DOM selectively
      const dayCard = itineraryEl.children[dayIdx];
      const li = dayCard.querySelectorAll('li')[idx];
      li.querySelector('.font-semibold').textContent = newIdea;
    }

    function addPickToPlan(title){
      if (!state.plan.length) {
        generatePlan();
      }
      // Add to first day's flex slot (or append a new flex)
      const firstDay = state.plan[0];
      if (!firstDay) return;
      const flexIdx = Math.min(3, firstDay.length-1);
      const newSlot = { label: 'Flex', idea: title + ' (from Picks)', id: crypto.randomUUID() };
      firstDay.splice(flexIdx, 0, newSlot);
      renderItinerary();
    }

    // Buttons & form
    document.getElementById('plannerForm').addEventListener('submit', (e)=>{
      e.preventDefault();
      state.budget = budgetCb.checked;
      state.early = earlyCb.checked;
      generatePlan();
    });
    generateBtn.addEventListener('click', (e)=>{ e.preventDefault(); state.budget = budgetCb.checked; state.early = earlyCb.checked; generatePlan(); });
    shuffleBtn.addEventListener('click', ()=>{
      if (!state.plan.length) return generatePlan();
      // Shuffle a random day
      const dayIdx = Math.floor(Math.random()*state.plan.length);
      let d = DESTS.find(x=>x.id===state.destId);
      // Fallback template for simple destinations
      if(!d){
        d = {
          id: state.destId,
          name: document.querySelector(`[data-id="${state.destId}"]`)?.textContent?.replace(/^\S+\s/,'') || 'Destination',
          emoji: 'üìç',
          tags: ['explore'],
          picks:[
            {title:'Top landmark', type:'sight', cost:'‚Çπ', tip:'Go early or late.'},
            {title:'Local food lane', type:'food', cost:'‚Çπ', tip:'Pick busy, clean stalls.'},
            {title:'Sunset viewpoint', type:'view', cost:'free', tip:'Carry water.'},
          ],
          activities:{
            chill:['Easy heritage walk','Cafe hop','Park picnic'],
            active:['Short hike or cycle','Museum + market loop','Sunrise photo walk'],
            night:['Local music night','Street snacks crawl','Night viewpoint']
          },
          influencers:[
            {handle:'@localtips', note:'Respect local customs and nature.'}
          ]
        };
      }
      state.plan[dayIdx] = buildDay(d, dayIdx);
      renderItinerary();
    });
    copyBtn.addEventListener('click', async ()=>{
      let d = DESTS.find(x=>x.id===state.destId);
      // Fallback template for simple destinations
      if(!d){
        d = {
          id: state.destId,
          name: document.querySelector(`[data-id="${state.destId}"]`)?.textContent?.replace(/^\S+\s/,'') || 'Destination',
          emoji: 'üìç',
          tags: ['explore'],
          picks:[
            {title:'Top landmark', type:'sight', cost:'‚Çπ', tip:'Go early or late.'},
            {title:'Local food lane', type:'food', cost:'‚Çπ', tip:'Pick busy, clean stalls.'},
            {title:'Sunset viewpoint', type:'view', cost:'free', tip:'Carry water.'},
          ],
          activities:{
            chill:['Easy heritage walk','Cafe hop','Park picnic'],
            active:['Short hike or cycle','Museum + market loop','Sunrise photo walk'],
            night:['Local music night','Street snacks crawl','Night viewpoint']
          },
          influencers:[
            {handle:'@localtips', note:'Respect local customs and nature.'}
          ]
        };
      }
      let text = `Trip: ${d.name} ‚Ä¢ ${state.dayCount} days ‚Ä¢ ${state.pace} pace ‚Ä¢ mood ${state.mood}\n\n`;
      state.plan.forEach((slots, i)=>{
        text += `Day ${i+1}:\n`;
        slots.forEach(s=>{ text += `- ${s.label}: ${s.idea}\n`; });
        text += '\n';
      });
      try{
        await navigator.clipboard.writeText(text);
        copyBtn.textContent = 'Copied!';
        setTimeout(()=>copyBtn.textContent='Copy summary',1200);
      }catch{
        alert('Copy not supported here. You can select the text manually.');
      }
    });
    clearBtn.addEventListener('click', ()=>{
      state.plan = [];
      itineraryEl.innerHTML = '';
      planMeta.innerHTML = '';
    });

    // Creative mode toggle
    creativeToggle.addEventListener('change', (e)=>{
      state.creative = e.target.checked;
      document.body.classList.toggle('from-indigo-900', !state.creative);
      document.body.classList.toggle('via-violet-800', !state.creative);
      document.body.classList.toggle('to-fuchsia-800', !state.creative);
      document.body.classList.toggle('from-rose-900', state.creative);
      document.body.classList.toggle('via-orange-700', state.creative);
      document.body.classList.toggle('to-yellow-600', state.creative);
      creativeBg.style.opacity = state.creative ? '1' : '0';
      // Nudge plan for extra playfulness
      if (state.plan.length) renderItinerary();
    });

    // About modal
    aboutBtn.addEventListener('click', ()=>{
      aboutModal.classList.remove('hidden');
    });
    closeAbout.addEventListener('click', ()=>{
      aboutModal.classList.add('hidden');
    });
    aboutModal.addEventListener('click', (e)=>{
      if (e.target === aboutModal) aboutModal.classList.add('hidden');
    });

    // Initialize
    renderDestChips();
    renderPicks();
    renderInfluencers();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9827d5a16489c1a1',t:'MTc1ODQzOTU4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
